# API服务 / API Services

## 概述 / Overview

API服务是控制塔后端的对外接口层，负责将计算引擎处理的数据和KPI指标提供给控制塔前端，支持各类业务场景的数据需求。

API services are the external interface layer of the control tower backend, responsible for providing data and KPI metrics processed by the calculation engine to the control tower frontend, supporting data requirements for various business scenarios.

## API分类 / API Classification

控制塔后端提供的API按功能域可分为以下几类：

The APIs provided by the control tower backend can be classified into the following categories by functional domain:

### Dashboard API

支持综合驾驶舱视图的数据需求，提供全局业务概览和核心KPI数据。

Support data requirements for the dashboard view, providing global business overview and core KPI data.

- 核心KPI数据接口 / Core KPI data interfaces
- 业务健康状态接口 / Business health status interfaces
- 告警信息接口 / Alert information interfaces
- 趋势图表数据接口 / Trend chart data interfaces

### 流程视图API / Process View API

支持流程视图的数据需求，提供Hauling作业各环节的详细数据。

Support data requirements for the process view, providing detailed data for each link of Hauling operations.

- 流程状态数据接口 / Process status data interfaces
- 环节KPI数据接口 / Stage KPI data interfaces
- 任务流转跟踪接口 / Task flow tracking interfaces
- 瓶颈分析数据接口 / Bottleneck analysis data interfaces

### 资源视图API / Resource View API

支持资源视图的数据需求，提供各类资源的状态和性能数据。

Support data requirements for the resource view, providing status and performance data for various resources.

- 资源列表数据接口 / Resource list data interfaces
- 资源状态数据接口 / Resource status data interfaces
- 资源性能指标接口 / Resource performance metric interfaces
- 资源位置数据接口 / Resource location data interfaces
- 资源健康数据接口 / Resource health data interfaces

### 通用服务API / Common Service API

提供跨功能域的通用服务支持。

Provide common service support across functional domains.

- 用户认证授权接口 / User authentication and authorization interfaces
- 数据字典接口 / Data dictionary interfaces
- 系统配置接口 / System configuration interfaces
- 文件上传下载接口 / File upload and download interfaces

## 核心API列表 / Core API List

以下是控制塔后端提供的核心API列表：

The following is a list of core APIs provided by the control tower backend:

### Dashboard核心API / Dashboard Core APIs

| API名称<br>API Name | 功能描述<br>Function Description | 请求方式<br>Request Method | 数据更新频率<br>Data Update Frequency |
|---------------------|--------------------------------|--------------------------|-------------------------------------|
| /api/dashboard/summary | 获取Dashboard摘要数据<br>Get Dashboard summary data | GET | 5分钟<br>5 minutes |
| /api/dashboard/kpi/production | 获取生产相关KPI数据<br>Get production-related KPI data | GET | 1小时<br>1 hour |
| /api/dashboard/kpi/equipment | 获取设备相关KPI数据<br>Get equipment-related KPI data | GET | 10分钟<br>10 minutes |
| /api/dashboard/kpi/energy | 获取能源相关KPI数据<br>Get energy-related KPI data | GET | 1小时<br>1 hour |
| /api/dashboard/alerts | 获取最新告警信息<br>Get latest alert information | GET | 实时<br>Real-time |
| /api/dashboard/trends | 获取KPI趋势数据<br>Get KPI trend data | GET | 1小时<br>1 hour |

### 流程视图核心API / Process View Core APIs

| API名称<br>API Name | 功能描述<br>Function Description | 请求方式<br>Request Method | 数据更新频率<br>Data Update Frequency |
|---------------------|--------------------------------|--------------------------|-------------------------------------|
| /api/process/status | 获取流程各环节状态<br>Get status of each process stage | GET | 1分钟<br>1 minute |
| /api/process/kpi/planning | 获取任务规划环节KPI<br>Get task planning stage KPIs | GET | 30分钟<br>30 minutes |
| /api/process/kpi/loading | 获取装载环节KPI<br>Get loading stage KPIs | GET | 15分钟<br>15 minutes |
| /api/process/kpi/transport | 获取运输环节KPI<br>Get transportation stage KPIs | GET | 15分钟<br>15 minutes |
| /api/process/kpi/unloading | 获取卸载环节KPI<br>Get unloading stage KPIs | GET | 15分钟<br>15 minutes |
| /api/process/tasks/tracking | 获取任务流转跟踪数据<br>Get task flow tracking data | GET | 5分钟<br>5 minutes |
| /api/process/bottleneck | 获取流程瓶颈分析数据<br>Get process bottleneck analysis data | GET | 30分钟<br>30 minutes |

### 资源视图核心API / Resource View Core APIs

| API名称<br>API Name | 功能描述<br>Function Description | 请求方式<br>Request Method | 数据更新频率<br>Data Update Frequency |
|---------------------|--------------------------------|--------------------------|-------------------------------------|
| /api/resources/list | 获取资源列表数据<br>Get resource list data | GET | 5分钟<br>5 minutes |
| /api/resources/vehicles/status | 获取车辆状态数据<br>Get vehicle status data | GET | 1分钟<br>1 minute |
| /api/resources/vehicles/location | 获取车辆位置数据<br>Get vehicle location data | GET | 30秒<br>30 seconds |
| /api/resources/vehicles/health | 获取车辆健康数据<br>Get vehicle health data | GET | 5分钟<br>5 minutes |
| /api/resources/equipment/status | 获取固定设备状态数据<br>Get fixed equipment status data | GET | 1分钟<br>1 minute |
| /api/resources/equipment/performance | 获取设备性能数据<br>Get equipment performance data | GET | 15分钟<br>15 minutes |
| /api/resources/detail/{resourceId} | 获取特定资源详细信息<br>Get detailed information for a specific resource | GET | 5分钟<br>5 minutes |

## 数据交互模式 / Data Interaction Mode

控制塔后端API服务支持以下数据交互模式：

The control tower backend API services support the following data interaction modes:

### 请求-响应模式 / Request-Response Mode

- **标准REST接口 / Standard REST Interface**: 采用HTTP/HTTPS协议，支持GET、POST、PUT、DELETE等方法
  
  Use HTTP/HTTPS protocol, supporting GET, POST, PUT, DELETE, and other methods

- **JSON数据格式 / JSON Data Format**: 请求和响应数据采用JSON格式，结构清晰易解析
  
  Request and response data use JSON format, with clear and easy-to-parse structure

- **分页查询支持 / Pagination Query Support**: 对于大量数据的查询提供分页机制
  
  Provide pagination mechanism for queries with large amounts of data

- **条件筛选支持 / Condition Filtering Support**: 支持多种查询参数进行数据筛选
  
  Support various query parameters for data filtering

### 实时数据推送 / Real-time Data Push

- **WebSocket接口 / WebSocket Interface**: 提供基于WebSocket的实时数据推送
  
  Provide real-time data push based on WebSocket

- **订阅-发布机制 / Subscribe-Publish Mechanism**: 支持客户端订阅特定主题的数据更新
  
  Support client subscription to data updates on specific topics

- **事件通知 / Event Notification**: 提供业务事件和告警的实时通知
  
  Provide real-time notification of business events and alerts

### 批量数据交换 / Batch Data Exchange

- **数据导出接口 / Data Export Interface**: 支持大量数据的批量导出
  
  Support batch export of large amounts of data

- **报表生成接口 / Report Generation Interface**: 支持各类统计报表的生成和下载
  
  Support generation and download of various statistical reports

## API安全与管理 / API Security and Management

控制塔后端API服务采用以下安全和管理机制：

The control tower backend API services adopt the following security and management mechanisms:

- **身份认证 / Identity Authentication**: 采用Token或OAuth2.0等机制进行身份认证
  
  Use mechanisms such as Token or OAuth2.0 for identity authentication

- **访问控制 / Access Control**: 基于角色的API访问权限控制
  
  Role-based API access permission control

- **数据加密 / Data Encryption**: 敏感数据传输加密和存储加密
  
  Encryption of sensitive data transmission and storage

- **API版本管理 / API Version Management**: 支持API版本演进和兼容性管理
  
  Support API version evolution and compatibility management

- **API监控 / API Monitoring**: 对API调用进行监控和性能分析
  
  Monitor API calls and perform performance analysis
